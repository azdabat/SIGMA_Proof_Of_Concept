title: LOLBIN Toolchain Abuse - .NET Build and Compile Utilities (msbuild/csc/installutil/regasm/pcwrun)
id: 4b1f9c22-8e8a-4ef9-bc85-5bff8b2b9f30
status: stable
description: |
  Detects suspicious use of .NET build/compile utilities frequently abused for proxy execution, script staging,
  and payload execution. Abstracted from L3 hunt pack (.NET toolchain + PCWRun).
author: Ala Dabat
date: 2026-01-08
tags:
  - attack.execution
  - attack.defense_evasion
  - attack.t1127
  - attack.t1218
  - attack.t1059
logsource:
  product: windows
  category: process_creation
detection:
  selection_tools:
    Image|endswith:
      - '\msbuild.exe'
      - '\csc.exe'
      - '\csi.exe'
      - '\ieexec.exe'
      - '\installutil.exe'
      - '\regasm.exe'
      - '\pcwrun.exe'
  selection_suspicious_args:
    CommandLine|contains|any:
      - '.csproj'
      - '.vbproj'
      - '.proj'
      - '.targets'
      - '/t:'
      - '/p:'
      - '/m'
      - '-target:'
      - '-reference:'
      - '/unsafe'
      - '.csx'
      - '-script'
      - 'codebase'
      - '/tlb'
      - ' -s '
      - 'frombase64string'
      - '-enc'
      - 'downloadstring'
      - 'invoke-expression'
      - 'http://'
      - 'https://'
  selection_suspicious_parent:
    ParentImage|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\mshta.exe'
      - '\winword.exe'
      - '\excel.exe'
      - '\powerpnt.exe'
      - '\outlook.exe'
  condition: selection_tools and (selection_suspicious_args or selection_suspicious_parent)
falsepositives:
  - Developer build servers / CI pipelines (baseline by host role + build agent accounts)
  - Legitimate software installers (tune by signer/publisher in the backend)
level: high
