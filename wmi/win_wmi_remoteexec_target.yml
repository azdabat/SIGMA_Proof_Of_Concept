title: WMI Remote Process Execution - Target Effect (wmiprvse.exe spawning LOLBins)
id: 1ad3f7e7-2c3f-4c25-87c8-9c95f4cc0c6b
status: stable
description: |
  Detects the target-side execution effect of WMI remote process instantiation:
  WmiPrvSE.exe spawning suspicious child processes.
author: Ala Dabat
date: 2026-01-08
tags:
  - attack.execution
  - attack.lateral_movement
  - attack.t1047
logsource:
  product: windows
  category: process_creation
detection:
  selection_parent:
    ParentImage|endswith: '\wmiprvse.exe'
  selection_child:
    Image|endswith:
      - '\cmd.exe'
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\mshta.exe'
      - '\rundll32.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\regsvr32.exe'
  selection_susp_args:
    CommandLine|contains|any:
      - '-enc'
      - 'frombase64string'
      - 'iex'
      - 'downloadstring'
      - 'http://'
      - 'https://'
      - '\\\\'
  condition: selection_parent and (selection_child or selection_susp_args)
falsepositives:
  - Legacy enterprise automation that uses WMI providers (rare; tune by known management servers)
level: high
